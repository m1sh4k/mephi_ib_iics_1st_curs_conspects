Регистр — доступная по постоянному адресу аппаратная ячейка.

Группы регистров:
- Ядро
- Системные
- Периферийные

Ключевое слово `volatile` указывает, что к переменной могут обращаться извне, все пользователи ядра, не только сама программа.


### Тактирование 

**Система тактирования** распределяет частоты по ядру и периферии.

Источники тактового сигнала:

- **HSI** _(High Speed Internal)_ — внутренний высокочастотный $8-16Мгц$
- **HSE** — внешний высокочастотный
- **LSI** — внутренний низкочастотный
- **LSE** _(Low Speed External)_ — внешний низкочастотный  $\sim32.768 Кгц$

Внешние источники надежнее, точнее. При неидеальном напряжении внутренние будут неточны.

### Прерывания

**Прерывание** — способ для микроконтроллера реагировать на важные события, не ожидая окончания основной программы.

$\boxed{Осн.Программа}\ \to\ _{\boxed{ПРЕРЫВАНИЕ}}\ \to \ \boxed{Осн.Программа}$

Нужно писать как можно меньше кода в прерывание, чтобы постоянно не останавливать основную программу.

Примеры прерываний:
- Уровень сигнала на ножке
- Прием байта по UART
- Нажатие кнопки
- По таймеру
  
### Память

**Flash (ПЗУ)** — постоянная память микроконтроллера.
Хранит в себе прошивку, кастомные настройки и таблицы.


### Периферия

**GPIO** _(General Purpose Input Output)_ — универсальные пины, через которые он может принимать/передавать данные.

Режимы работы:
- Input
- Output

## Атаки
### Аппаратные атаки

- **Voltage/clock glitching** — кратковременный сбой питания/клока
- Подключение через неотключенный отладочный интерфейс
- **Side channel attack** — измерение тока/ЭМ-излучения
  
### Программные уязвимости

- **Переполнение буфера** — запись данных за пределы выделенной области памяти
- Слабая валидация данных
- Использование **магических** _(скрытых)_ команд  для отладки


### Уязвимости прошивки

- Захардкоженные ключи
- Открытые OTA-интерфейсы
- Неправильное управление памятью
- Прямая загрузка прошивки без шифрования

## Защита

### RDP

**RDP** — защищает flash память от считывания
